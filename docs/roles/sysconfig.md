# Настройка ОС через параметры ядра в CentOS/RHEL с помощью Ansible

??? abstract
    1. [Общее описание](#общее-описание)
    2. [Параметры](#параметры)
    3. [Теги](#теги)
    4. [Примеры](#примеры)
    5. [Дополнительные материалы](#дополнительные-материалы)

## Общее описание
Роль меняет системные параметры в ОС. Например - такие параметры как размер сегмента разделяемой памяти, ограничение на число запущенных процессов, а также включать функции наподобие маршрутизации и т.д. Переопределяются необходимые параметры в конфигурационном файле '/etc/sysctl.conf'.

!!! info
    Основные параметры перечислены в переменных sysctl_config_el7 для CentOS 7 и sysctl_config_el8 для CentOS 8 в файле roles/sysconfig/defaults/main.yml.

## Параметры
|Название переменной               | Тип переменной | Значения по умолчанию | Описание                                                                                |
|:---------------------------------|:--------------:|:---------------------:|:----------------------------------------------------------------------------------------|
|ipv6_grub_disable                 | boolean        | undef (true)          | Отключает поддержку протокола IPv6.                                                     |
|sysctl_param_custom               | array          | undef                 | Меняет перечисленные через список параметры.                                            |
|lxc_hosted                        | boolean        | undef (false)         | Включает или отключает `ip_forward` в зависимости, запускаются ли на узле "контейнеры". | 


## Теги
|Тег                  | Описание                                          |
|:--------------------|:--------------------------------------------------|
|disable_ipv6_grub    | Вносит изменения в загрузчик ОС.                  |
|disable_ipv6_kernel  | Меняет параметры ядра.                            |
|disable_ipv6_network | Отключает поддержку на уровне сетевых интерфейсов.|
|ip_forward           | Отключает или включает перенаправление пакетов.   |

## Примеры

!!! example "inventory/hosts"
    ```
    [example-servers]
    <host_name> ansible_ssh_host=<host_ip> ansible_ssh_user=<user_name_for_connect>

    [example-servers:vars]
    ansible_connection=ssh
    ipv6_grub_disable=false
    ```

## Дополнительные материалы

- [The Linux Kernel documentation](https://www.kernel.org/doc/html/latest/admin-guide/sysctl/index.html)
- [Настройка ядра с помощью sysctl](http://netsago.org/ru/notes/2008/10/)